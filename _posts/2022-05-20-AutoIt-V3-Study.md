---
title: "즐거운 AutoIt 코딩 (교재)"
excerpt: ""
categories: "blog"
toc: true
date: 2022-05-20
last-modified-at: 2022-05-20
---

# 즐거운 AutoIt 코딩 (교재)

## 1. 오토잇 소개

오토잇은 이름 그대로 마이크로소프트 윈도우즈 운영체제에서 무엇인가를 자동화하는 데에 강점이 있는 프로그래밍 언어입니다. 배우기 쉬운 베이직 문법으로 되어 있으며, 자동화 이외에도 다양한 프로그램을 만들 수 있습니다. 무엇보다도 키보드, 마우스 시뮬레이션 기능을 아주 쉽게 사용할 수 있습니다. 이 특징 덕택에 오토잇 문법을 모르는 시각장애인도 유용한 자동화 프로그램을 쉽게 만들 수 있습니다. 뿐만 아니라 오토잇은 GUI도 쉽게  구현할 수 있습니다. 물론 복잡한 GUI를 만들기에 부족한 점도 있고 스크린리더 반응 속도도 조금 늦다는 단점도 있습니다만, 압도적으로 쉽게 GUI를 구현할 수 있다는 장점은 아무리 칭찬해도 지나치지 않습니다.

오토잇은 스크립트 언어이면서도 컴파일을 통해 단독 실행 파일을 만들 수 있습니다. 가끔 백신 프로그램이 바이러스로 오진하기 합니다만 그건 다른 프로그래밍 언어들도 마찬가지입니다. 모두 마이크로소프트의 디지털 서명을 받지 않았기 때문입니다. 보통 스크립트 언어들을 단독 실행 파일로 만들면 그 크기가 상당히 큽니다. 단 한줄의 print 함수만 동작하는 데에도 10MB가 넘기도 하고 때론 수 십MB를 넘기도 합니다. 하지만 오토잇은 1MB를 넘지 않습니다. 아주 경제적이지요.

오토잇에 대한 소개는 이정도에서 마치고 오토잇 개발 환경을 만들어 봅시다. 말이 좋아 개발 환경이지 그냥 오토잇 개발 도구를 다운로드 받아서 설치하는 걸로 끝입니다.


## 2. 오토잇 설치

오토잇은 <https://www.autoitscript.com>에서 다운로드 할 수 있습니다. 귀찮은 분들은 아래 링크에서 곧바로 다운로드 받을 수 있습니다.

<https://www.autoitscript.com/cgi-bin/getfile.pl?autoit3/autoit-v3-setup.zip>

2022년 5월 현재 최신 버전은 3.3.16.0이며, 22년 3월 6일에 업데이트 되었습니다. zip 압축을 해제하고 설치 프로그램을 실행하세요. 설치 옵션은 변경할 필요가 없습니다. 디폴트로 설치하세요. 

이제 오토잇으로 코딩할 준비가 끝났습니다.


## 3. 오토잇 코드 편집기

오토잇을 설치하면 오토잇 언어에 최적화된 SciTe 편집기가 함께 설치됩니다. 오토잇 전용 SciTe 편집기는 센스리더가 제대로 지원해 주지 못합니다. 이 편집기를 사용하고자 한다면 센스리더 대신 NVDA를 사용하세요. 하지만 NVDA도 자동완성 목록을 읽어 주지 못합니다. 

소스코드의 인코딩은 File' 메뉴에서 'encoding'의 하위 메뉴 'UTF-8'을 선택하세요.

센스리더 사용자도 걱정마세요. 메모장으로 편집하시고 파일 확장자를 'au3'으로 바꾸세요. 그리고 윈도우 탐색기에서 팝업 키를 누르면 곧바로 소스 파일을 실행하거나 컴파일할 수 있는 컨텍스트 메뉴가 열립니다. 참 쉽지요!

확장자를 .au3으로 바꾸는 것도 귀찮다면 파일 탐색기에서 팝업 메뉴를 열고 '새로 만들기'에서 곧바로 오토잇 소스 코드 파일을 생성할 수 있습니다.


## 4. 첫번째 오토잇 프로그램 "Hello, World"

대부분의 프로그래밍 언어의 첫번째 예제는 바로 "안녕, 세계야"를 화면에 표시하는 것입니다. 오토잇도 예외가 아닙니다. 편집기에 다음과 같이 입력해 보세요.

### 01_hello.au3

```autoit

MsgBox(0, "첫번째 프로그램", "안녕, 세계야")

```

SciTe에서는 소스 코드를 저장한 후 F5로 실행 결과를 볼 수 있습니다. 메모장이라면 윈도우 탐색기에서 팝업 키를 누르고 Run Script 메뉴를 선택하시면 hello.au3이 실행됩니다.

보통 대다수의 프로그래밍 언어는 콘솔 화면에 "안녕, 세계야"가 출력될 것입니다. 오토잇은 처음부터 콘솔 화면이 아니라 GUI 방식으로 결과를 보여 줍니다.

이 코드를 설명합니다.

MsgBox는 메시지상자를 화면에 표시하는 함수입니다. 이 메시지상자가 표시되는 동안 프로그램은 일시 정지됩니다. 이 상자가 닫히면 다음 코드가 실행됩니다.

MsgBox에서 대소 문자를 구별할 필요가 없습니다. msgbox나 MsgBox나 MSGBOX나 msGboX는 모두 같습니다. 귀로 듣기 편한 방식으로 입력하셔도 됩니다.

오토잇은 베이직 스타일의 문법을 가지고 있습니다. 베이직류 언어들의 문법은 대소문자를 엄격하게 구별하지 않습니다. 

대소문자를 자유롭게 사용하는 것도 좋습니다만, 일반적인 관습에 따르는 것도 좋습니다. 일반적인 관습은 간단합니다.

단어의 시작 글자를 대문자로 씁니다. 단어가 축약된 경우에는 세글 자 이상인 경우 첫글자만 대문자로 쓰고 두 글자인 경우에는 두 글자 모두 대문자로 적는다는 관습이 있습니다만 일단은 단어의 첫 글자만 대문자로 쓴다는 것에만 주의합시다.

MsgBox는 함수입니다. 함수는 어떠한 기능을 실행하기 위한 장치입니다. 함수를 실행하려면 뒤에 반드시 "("와 ")"가 필요합니다. 괄호 사이에는 장치에 투입될 재료들을 적어 줍니다.

라면 공장을 생각해 봅시다. 라면을 만드려면 밀가루, 고추가루, 소금 등등이 필요할 겁니다. 이러한 재료를 넣으면 기계가 철컹 철컹 돌아가면서 봉지에 담긴 라면이 탁 나오는 겁니다.

위 예제에서 괄호 속에 든 0, "첫번째 프로그램", "안녕, 세계야"는 기계에 넣을 재료들입니다.

이것을 인수(argument)라 부릅니다. 일단은 그냥 재료라고 이해하고 넘어 갑시다.

첫번째 재료: 0

MsgBox의 첫번째 재료는 숫자 0입니다. 이 숫자는 메시지상자의 스타일을 결정합니다.

0은 '확인' 버튼을 가진 메시지상자를 만듭니다. 이 숫자를 1로 변경해 보겠습니다. 

### 02_hello2.au3

```autoit

MsgBox(1, "첫번째 프로그램", "안녕, 세계야")

```

실행 결과를 보시면 '확인' 버튼과 '취소' 버튼을 가진 메시지상자가 나타날 것입니다. ESC를 누르면 '취소' 버튼을 누른 것과 같은 동작을 합니다.

이 숫자를 2로 변경하면 '중단', '다시 시도', '무시' 버튼을 가진 메시지상자가 나타납니다. 자세한 건 뒤에 다시 다루겠습니다. 급한 분들은 오토잇 메뉴얼을 찾아 보세요.

첫번째 재료 숫자를 변경함으로써 메시지상자의 스타일을 바꿀 수 있고 단순한 메시지 표시 뿐만 아니라 우리들의 선택을 프로그램에 반영할 수 있습니다.

괄호 내의 ","는 재료와 재료를 구별하기 위해 사용합니다. 만약 함수의 재료가 하나라면 쉼표를 쓸 필요가 없습니다. 재료가 두 개 이상일 때 그것들을 구별하기 위해 쉼표를 사용합니다.

두 번째 재료 "첫번째 프로그램" 처럼 쿼테이션이나 어퍼스트로피로 시작하고 끝나는 것들을 통칭 문자열이라고 부릅니다. 문자가 하나일 수도 있고 여러 개일 수도 있는데 문자 여러 개가 줄줄이 붙어 한 줄로 나란히 있으니 "열"이라 부르는 것입니다. 영어로는 string이라 부릅니다.

그렇다면 숫자 0과 문자열 "0"에는 어떤 차이가 있을까요? 이제 프로그램을 또 수정해 봅시다. 첫번째 재료를 "0"으로 바꾸고 hello3.au3으로 저장한 후 실행해 봅니다.

### hello3.au3

```autoit

MsgBox("0", "첫번째 프로그램", "안녕, 세계야")

```

실행 결과는 hello.au3 파일과 똑같습니다. 어찌된 일일까요?

일반적으로 프로그래밍 언어에서  숫자 0과 문자열 "0"은 완전히 다릅니다. 숫자는 덧셈을 할 수 있지만 문자열은 덧셈을 할 수 없는 것이 원칙입니다. 하지만 오토잇은 다릅니다. 숫자를 때론 문자열로 바꿔 주고 숫자로 이루어진 문자열은 알아서 숫자로 바꿔 줍니다. 오토잇 메뉴얼에 의하면 오토잇에는 단 하나의 데이터 타입이 있다고 합니다. 그것이 바로 베리언트(variant) 타입입니다. 베리언트 타입은 무엇이든 될 수 있습니다. 웬만한 건 오토잇이 알아서 해 줍니다. 다만 사용자가 문자열로 쓸 것인지 숫자로 쓸 것인지 확실하게 정해 주어야할 때가 종종 있습니다.

hello.au3 파일의 두번째 줄에 다음과 같은 내용을 추가해 봅시다.

MsgBox(0, "숫자 계산", 12+34)

34라는 결과를 볼 수 있습니다. 다른 언어들에서는 숫자를 곧바로 문자열처럼 출력했기 때문에 에러가 발생할 가능성이 높습니다. 하지만 오토잇은 알아서 숫자 결과를 문자열로 바꿔 주었습니다. 이제 세번 째 줄에 다음과 같이 추가해 봅시다.

MsgBox(0, "문자열 결합", 12 & 34)

실행 결과는 흥미롭게도 1234입니다.

오토잇에서 "+"는 숫자의 덧셈을 의미합니다. "&"는 문자열을 결합할 때 사용합니다. 오토잇은 "+"를 만나면 양쪽을 모두 숫자로 바꿔 계산하고, "&"를 만나면 숫자를 문자열로 바꿔서 결합합니다.

MsgBox의 두 번째 재료는 문자열로 메시지상자의 제목(caption)이 됩니다. 세번째 재료는 메시지상자 본문이 됩니다.


## 5. 두번째 프로그램

오토잇 메뉴얼에 나오는 두번째 예제는 간단한 자동화입니다. 메모장을 실행하고 메모장에 특정 문장을 쓰고, 메모장을 닫습니다. 메모장을 닫을 때 "변경 내용 저장" 대화상자가 나타날 것입니다. 이때 "저장 안 함"을 누르도록 하겠습니다. 다음은 소스 코드입니다. 

### 04_notepad.au3

```autoit

Run("notepad.exe")
WinWaitActive("제목 없음 - Windows 메모장")
Send("여러분 안녕하세요. 저는 메모장입니다.")
Sleep(3000)
WinClose("*제목 없음 - Windows 메모장")
Send("!n")

```autoit

소스 코드를 해설합니다.

Run("notepad.exe")

Run 함수는 컴퓨터 내에 있는 실행 파일을 실행시키는 함수입니다. "notepad.exe"는 메모장의 실행 파일입니다. 

WinWaitActive("제목 없음 - Windows 메모장")

WinWaitActive함수는 특정 대화상자가 화면에 활성화되기를 기다리는 함수입니다. "제목 없음 - Windows 메모장"이란 제목을 가진 대화상자가 나타날 때까지 오토잇은 대기상태에 들어 갑니다. 즉 메모장이 실행되기를 기다리는 거지요. 메모장 프로그램이 활성화 되면 다음 줄이 실행됩니다. 윈도우즈11의 경우 메모장 제목줄에 "Windows" 단어가 없습니다.

Send("여러분 안녕하세요. 저는 메모장입니다.")

Send 함수는 문자열을 활성화된 프로그램에게 전달하는 함수입니다. 우리가 꼭 키보드를 타이핑한 것처럼 말입니다. Send 함수는 키보드 시뮬레이션 기능인 셈입니다. 이 줄이 실행되면 메모장 편집창에 "여러분 안녕하세요. 저는 메모장입니다."라는 텍스트가 씌여집니다.

Sleep(3000)

Sleep은 프로그램 실행을 중지하고 대기하는 함수입니다. 이 함수의 재료는 시간입니다. 시간 단위는 1000분의 1초입니다. 통상 밀리초(ms)라 불리는 것입니다.

WinClose("*제목 없음 - Windows 메모장")

WinClose는 특정 대화상자를 닫기 위한 함수입니다. 그런데 "제목 없음" 앞에 "*"가 붙습니다. 메모장이 활성화 되면 제목 처음에 "*"를 추가하기 때문입니다.

Send("!n")

메모장을 종료할 때 메모장 편집창의 내용이 수정되었다면 "변경 사항 저장"을 묻는 대화상자가 나타납니다. 이때 우리는 "저장 안 함" 버튼을 누르거나 단축키로 Alt+n을 누를 겁니다. Send 함수의 재료에 알트 키도 넣을 수 있습니다. 바로 "!"입니다. "!"는 알트키를 의미합니다. "!n"이란 Alt+n 단축키와 같습니다. 이 줄이 실행되면 메모장이 "변경 내용 저장" 없이 종료되며 동시에 04_notepad.au3 프로그램도 종료하게 됩니다.

WinWaitActive를 꼭 사용할 필요는 없습니다. 이 줄 대신 그냥 Send(3000) 누르셔도 대체로 동일한 결과가 나옵니다. 메모장은 대체로 3초 안에 실행을 마치기 때문입니다.

WinClose 함수도 꼭 사용할 필요가 없습니다. Send("!{f4}")로 대체할 수 있습니다. 앞서 말씀 드린 것처럼 "!"는 Alt 키입니다. "{f4}"는 여러분이 기대한 바로 그 F4 키입니다. 즉 이 줄은 Alt+F4를 눌러 메모장을 종료하라는 것입니다.

그렇다면 왜 WinWaitActive, WinClose 같은 함수를 사용할까요? 그건 정확히 메모장 단 하나에만 프로그램을 동작시키기 위함입니다. 컴퓨터는 사용자의 의사와 관계 없이 특정한 대화상자를 활성화시킬 수 있습니다. 이럴 때 notepad.au3 파일이 실행되면 문자열이 엉뚱한 곳에 전달된다든지 예기치 못하게 특정 프로그램을 종료시킬 수도 있습니다. 따라서 에러를 줄이기 위해 WinWaitActive 같은 함수를 사용하는 것입니다.

한번 만들어 봅시다.

윈도우 디펜더의 실시간 감시 기능을 켜거나 끄고 싶습니다. Send, Sleep 함수만으로 실시간 검사 기능을 토글해 보세요.


## 6. 세번째 프로그램

우리가 만들 세번째 오토잇 프로그램은 바로 계산기입니다. 소스코드는 다음과 같습니다.

###  05_calc.au3

```autoit

$Result = 0
While 1
   $s = InputBox("계산기", "수식 입력", $Result)
   If Not $s Then Exit
	  $Result = Execute($s)
   WEnd

```

여섯 줄로 간단하게 계산기를 구현해 보았습니다. 코드에 대해 설명해 보겠습니다.

$Result = 0

$Result처럼 앞에 "$"가 붙은 것들을 변수(variables)라 부릅니다. 오토잇에서 변수를 만들 때에는 반드시 앞에 "$"를 붙여야 합니다. 그렇지 않으면 에러가 발생합니다. 

변수는 반찬통에 붙이는 점자 라벨과 비슷합니다. 냉장고에 든 반찬통에 무엇이 들어 있는지 시각장애인들은 쉽게 알아내기 어렵습니다. 이럴 때 점자 라벨을 붙이면 편리합니다. 오토잇도 마찬가지입니다. 코딩을 할 때 많은 데이터를 다루게 되는데 이때 각각의 데이터를 쉽게 기억하고 사용하기 위해 변수가 필요합니다.

오토잇에서 변수는 어떤 데이터에도 자유롭게 붙일 수 있습니다. 같은 변수를 다른 종류의 데이터에 붙여도 괜찮습니다. 이것을 동적 타이핑(dynamic typing)이라 부릅니다. 동적 타이핑 방식의 언어들은 초보자들 입장에서 코딩하기에는 편리하지만 프로그램의 연산 속도를 떨어 뜨리는 주범이기도 합니다. 대다수의 스크립트 언어들이 컴파일 언어들에 비해 속도가 현저하게 느린 이유가 바로 이것입니다.

* 대입 연산자

수학에서 "="은 "같다"는 의미입니다. 그런데 코딩에서는 의미가 조금 다릅니다. 오른쪽에 있는 숫자 0을 왼쪽에 있는 $Result 변수에 "대입"한다는 의미입니다. 거칠게 표현하자면 $Result란 라벨이 붙은 반찬통에 숫자 0을 집어 넣는 것으로 이해하셔도 좋습니다.

"="을 대입 연산자라 부르는데요. 바로 오른쪽에 있는 것을 왼쪽에 넣는다는 의미일 뿐입니다. 이런 코드가 있다고 생각해 봅시다.

$Result = $Result + 1

수학으로 치면 이런 식은 에러입니다. $Result에는 0이 들어가 있지요. 

0 = 0 + 1

0=1

그런데 코딩에서는 문제가 되지 않습니다. 먼저 오른쪽을 계산합니다. 이 결과를 다시 $Result에 대입합니다. 결과는 $Result에 1이 들어갑니다.

$Result라는 변수를 만든 이유는 여기에 계산 결과를 담아서 화면에 표시하기 위해서입니다. 자세한 건 아래에서 다시 설명하겠습니다.

While 1

While은 반복 작업을 시키기 위해서 사용합니다.

While과 짝을 이루는 것은 WEnd입니다. While과 WEnd 사이에 있는 코드를 계속 반복 실행합니다. 계산기를 사용할 때 딱 한번만 사용하고 종료시키지 않습니다. 여러 번 계산할 수도 있고 앞서 계산한 결과에 추가적인 계산을 이어갈 수도 있습니다. 

그런데 무한하게 코드가 반복되는 것도 비효율적입니다. While 뒤에 조건을 달아서 반복을 제한할 수 있습니다. 그런데 While 뒤에 1을 붙인 이유는 무한 반복을 시키기 위해서입니다.

While로 코드를 반복 실행할 때 매번 While 뒤에 있는 것으로 참과 오류를 구별합니다. 만약 참이면 계속 반복하고 오류면 반복을 중지하고 W
End 다음에 있는 코드를 실행합니다. 

참과 오류를 오토잇에서는 True/False로 표현합니다. 이것들은 진리값 타입의 데이터이며 영어로는 불리언(Boolean)이라고 부릅니다. 이 불리언 타입은 숫자 타입, 문자열 타입과 함께 가장 기초적인 데이터 타입 중 하나입니다. 이런 데이터가 있다는 것을 꼭 기억하세요.

참과 오류를 구별할 때 0은 항상 오류이며 0을 제외한 숫자는 모두 참입니다. 무엇인가가 있으면 참, 아무 것도 없으면 오류인 셈입니다. 문자열의 경우 "" 처럼 아무 내용도 없으면 오류, 무엇이라도 들어 있으면 참입니다.

   $s = InputBox("계산기", "수식 입력", $Result)

InputBox는 MsgBox와 반대의 역할을 합니다. MsgBox는 사용자에게 무엇인가를 알려 주기 위한 기능이라면 InputBox는 사용자가 컴퓨터에게 무엇인가를 알려줄 때 사용합니다. 계산기의 경우 계산 수식을 컴퓨터에게 전달할 필요가 있습니다. 이럴 때에 InputBox를 사용합니다.

InputBox 함수에는 많은 재료들을 넣을 수 있습니다. 이번에는 그중에서 가장 중요한 맨 앞 세 개만 넣어 보겠습니다.

첫번째 "계산기"란 문자열은 InputBox의 제목에 해당합니다. 두번째 '수식 입력"은 편집창의 역할을 설명하는 텍스트입니다. 세번째 $Result는 기본값입니다. InputBox가 화면에 표시될 때 편집창이 하나 나타나는데 그 편집창에 들어갈 기본 내용입니다. While로 계산이 반복될 때 $Result 변수에 담긴 계산 결과 값이 편집창에 표시될 예정입니다. 

   If Not $s Then Exit

If로 시작하는 문장을 조건문이라고 합니다. If와 Then 사이에 들어 있는 내용이 참이면 Then 다음의 코드를 실행하고 오류이면 If 다음 코드로 건너 뜁니다.

$s 변수에는 InputBox의 실행 결과가 들어 갑니다. InputBox의 편집창에 "1+2"라 적으면 $s에는 "1+2"가 들어 갑니다. 만약 아무 것도 입력하지 않고 엔터 키를 치거나 ESC를 누르는 경우 $s에는 텅빈 문자열이 들어 갑니다. 텅빈 문자열은 ""으로 표현할 수 있습니다.

Not은 참을 오류로 바꾸고 오류를 참으로 바꾸는 역할을 합니다.

만약 $s에 수식이 들어 있다면 $s는 참이 되고 Not 때문에 다시 오류가 됩니다. $s에 수식이 들어 있다면 If 조건문은 실행되지 않습니다. 만약 $s가 텅빈 문자열이라면 오류가 되고 다시 Not 때문에 참이 될 겁니다. 그러므로 Then 다음에 있는 Exit가 실행됩니다.

Exit

Exit는 이름 그 대로 프로그램을 종료하라는 명령어입니다.

	  $Result = Execute($s)

$s에 수식이 담겨 있다면 그 수식을 계산하게 하는 코드입니다.

Execute 함수에는 재료가 하나 들어 갑니다. 그 재료는 문자열입니다. Execute는 이 문자열을 오토잇 코드라 판단하고 그것을 계산합니다. 수식이 들어 있다면 그 수식을 계산해서 결과 값을 $Result에 넣어 줍니다.

   WEnd

WEnd는 앞서 설명했듯 While과 짝을 이룹니다. 코드에서 WEnd를 만나면 While로 올라가서 다시 실행됩니다.

한번 calc.au3 파일을 실행해 보세요. 그리고 계산기처럼 수식을 넣어 보세요.

덧셈: +
뺄셈: -
곱셈: *
나눗셈: /

자! 이것으로 오토잇의 소개를 마치겠습니다.

## 7. 변수 이름 짓기

변수 이름은 $로 시작해야 합니다. $ 뒤에 이어서 문자, 숫자, 언더바(_)를 하나 이상 사용할 수 있습니다. 변수 이름도 함수 이름처럼 대소문자를 가리지 않습니다. 예를 들어 $name과 $Name과  $NAME은 모두 같은 변수입니다.

변수 이름을 지을 때에도 규칙을 정해서 사용하면 좋습니다. 오토잇은 "헝가리언 표기법"을 따른다고 합니다. 먼저 $ 다음에 데이터 타입을 알 수 있도록 소문자로 시작하고 그 다음에 실질적인 변수의 이름을 적습니다. 데이터 타입과 예제는 다음과 같습니다.

$a: 배열, $aArray[0]

$b: 진리값, $bBool = True

$f: 소수점 숫자, $fFloat = 123.45

$i: 소수점 없는 숫자, $iInteger = 123

$m: 맵 데이터, $mMap[]

$n: 모든 숫자

$s: 문자열, $sName = "AutoIt"

$v: 베리언트 타입

변수 뒤에는 변수의 이름을 적습니다. 만약 사람 이름이라면 $sName이라는 식입니다. 이때 Name의 첫 글자는 대문자로 사용합니다. 함수명을 적을 때와 같은 규칙을 사용하는 게 좋습니다.


## 8. 변수 선언하기

변수는 Local, Global이라는 키워드와 함께 선언합니다. Dim이라는 키워드로 선언할 수도 있는데 추천하는 방식은 아닙니다. 

Local $sName

한 줄에 여러 변수를 선언할 수도 있습니다.

Global $sName, $sAddress, $iAge

변수 선언과 동시에 데이터를 변수에 저장할 수 있습니다. 이것을 변수 초기화라고 합니다.

Local $sName = "AutoIt"

변수를 초기화할 때 Local, Global, Dim 키워드를 생략할 수도 있습니다만, 추천하지는 않습니다. 명시적으로 Local, Global 키워드를 사용하세요. 무엇보다도 Global은 꼭 사용하세요.

$iAge = 15

키워드 없이 변수가 초기화 된다면 자동으로 Dim 키워드가 붙은 것과 같습니다.

## 9. 상수 선언

상수(Constants)는 한번 저장된 데이터를 변경할 수 없습니다. 상수는 Const 키워드로 선언합니다. 상수는 $뒤에 e를 붙여서 타입을 표시합니다. e는 Enum의 첫 글자입니다.

Const $ePi = 3.141592

Enum 키워드를 써서 여러 상수를 한 줄에 선언할 수 있습니다.

Enum $eSunday = 1, $EMonday, $eTuesday ... 

$eMonday는 숫자를 저장하지 않아도 자동으로 2가 부여됩니다. 

Step 키워드를 써서 증가되는 값을 조절할 수 있습니다.

Enum Step 2 $eSunday, $eMonday, $eTuesday...

각 상수에는 차례대로 0, 2, 4 ,... 으로 값이 부여됩니다.

Step에 곱셈기호 *를 사용하면 배수로 상수의 값을 지정할 수 있습니다.

Enum Step *2 $eSunday, $eMonday...

순차적으로 값이 1, 2, 4, 8...로 상수 값이 부여됩니다.

## 10. 변수의 범위

함수 안에서 Local로 선언된 변수는 함수 안에서만 유효합니다. 함수 안에서 Global로 선언된 변수는 함수 밖에서도 유효합니다. 함수 밖에서 선언된 Local은 사실상 Global과 같습니다. 함수 밖에서 Global로 선언된 변수는 해당 파일 전체에서 사용 가능합니다.

Dim으로 변수가 선언될 때 함수 밖에서는 Global로 선언되고 함수 안에서는 Local로 선언됩니다. 

변수 이름 짓는 방법에 변수의 범위를 추가할 수 있습니다. 만약 Global로 선언된 변수라면 $뒤에 g_를 붙입니다.

Global $g_sName = "AutoIt"

만약 Local이라면 $ 뒤에 g_를 붙이지 않습니다. 우리는 이것을 통해 변수의 적용 범위와 변수의 종류와 변수의 이름을 모두 알 수 있습니다.


## 11. 배열(arrays)

배열은 여러 개의 변수를 저장할 수 있는 상자입니다. 배열은 이름처럼 순서가 중요합니다. 배열은 순서를 가지고 있기 때문에 처리 속도가 빠릅니다. 다만 무조건 순서대로 일을 처리해 나가야만 합니다. 

또 배열에는 1차원 배열, 2차원 배열, n차원 배열을 만들 수 있습니다. 배열의 차원은 배열을 선언할 때 결정됩니다. 뒤에 상세하게 다루겠습니다.

배열에 저장될 데이터의 숫자는 정해져 있습니다. 이것을 배열의 크기라 불러도 좋습니다. 배열의 크기를 조절하려면 Redim을 사용할 수 있지만 UDF의 _Array 헤더 파일을 사용하는 것이 더 좋습니다.

배열은 다음과 같이 선언합니다.

Local $aNames[5]

원소가 다섯 개인 1차원 배열입니다. 배열을 선언할 때에는 반드시 Local, Global 키워드를 반드시 사용해야 합니다.

배열을 선언하면서 동시에 원소를 초기화 할 수 있습니다.

Local $aNames[3] = ["AutoIt", "Java", "Python"]

원소를 초기화 하는 경우 원소의 갯수는 생략 가능합니다.

Local $aNames[] = ["AutoIt", "Java", "Python"]

Local $aNames = ["AutoIt", "Java", "Python"]

다차원 배열은 다음과 같이 선언합니다.

Local $aInfo[3][2]

이것은 2차원 배열을 선언한 것입니다. 초기화하는 방법은 다음과 같습니다.

Local $aInfo[3][2] = [["대한민국", "서울"], ["일본", "도쿄"], ["중국""베이징"]]

배열 속에 들어 있는 원소(elements)에는 번호가  부여됩니다. 이 번호를 가지고 배열 속의 원소에 접근할 수 있습니다. 한 반에 학생 숫자가 20명이라면 이름은 달라도 학생들에게 번호를 부여하여 이름을 몰라도 해당 학생을 호출할 수 있는 것과 같습니다.

Local $aNames[3] = ["AutoIt", "Python", "Java"]

$aNames[0] --> "AutoIt"

$aNames[2] --> "Java"

배열 내 첫번째 원소의 위치 번호는 0입니다. 0에서부터 오른쪽으로 가면서 1씩 증가합니다. 이것을 배열의 인덱스라고 합니다.

다차원 배열에서도 인덱스를 사용할 수 있습니다.

Local $aInfo[3][2] = [["대한민국", "서울"], ["일본", "도쿄"], ["중국""베이징"]]

$aInfo[1][0] --> "일본"

$aInfo[2][1] --> "베이징"

배열 속에는 무엇이든지 넣을 수 있습니다. 심지어 배열 속에 배열을 넣어도 됩니다. 배열은 64차원까지 가능하며, 배열 속의 원소의 최대 갯수는 2의 24승 개(16777216)입니다.

12. 맵(map)

맵 데이터는 사전 데이터와 유사하지만 접근성이 더 좋다고 합니다. 맵은 키(key)와 값(value)을 한쌍으로 하는 형식으로 데이터를 저장합니다. 키는 숫자와 문자열을 쓸 수 있는데 이때 사용하는 숫자는 배열의 인덱스와 완전히 다릅니다. 단지 "키"일 뿐 인덱스가 아닙니다. 또 맵 데이터는 배열과 달리 쉽게 원소를 추가하거나 제거할 수 있습니다. 또 TableKeys() 함수를 사용하면 맵의 모든 키를 확인할 수 있습니다. 맵은 다음과 같이 선언합니다.

Global $mScore[]

맵도 배열처럼 Local, Global 키워드를 반드시 사용해야 합니다.

"[]" 사이에 아무 값도 넣지 않으면 맵이 됩니다. 여기에 숫자를 넣으면 배열이 됩니다.

Local $aScore[3] 

원소의 갯수를 쓰지 않더라도 배열 형식으로 초기화 하면 배열이 될 뿐 맵이 되지 않습니다. 맵은 절대로 초기화하지 마세요.

맵에 데이터를 추가하려면 다음과 같이 합니다.

Local $mInfo[]; 선언

$mInfo["대한민국"] = "서울"

$mInfo["일본"] = "도쿄"

$mInfo["china"] = "베이징"

추가한 데이터의 내용은 이렇게 찾아 볼 수 있습니다.

$sCity = $mInfo["대한민국"]

$sCity 변수에는 문자열 "서울"이 들어갑니다.

만약 키가 영문자로 되어 있다면 "." 연산자를 쓸 수 있습니다.

$sCity = $mInfo.china

$sCity에는 문자열 "베이징" 이 저장됩니다. 대괄호를 쓰지 않고 "."으로 china가 연결된 점을 주목하세요. 이 점이 일반적인 사전 데이터 타입과의 차이입니다.


## 13. 매크로(Macro)

우리가 오토잇으로 프로그램을 만들 때 너무 너무 자주 사용하는 데이터들이 있습니다. 오토잇은 그것들을 매크로라는 이름으로 우리에게 제공해 줍니다. 만약 올해 연도를 알고 싶으신가요? 골뱅이 "@" 뒤에 Year을 붙여 보세요. 그 자리에 올해 연도가 들어 갑니다. 바탕화면 폴더의 주소를 알고 싶으세요. @DesktopDir을 사용하세요. 교재 말미에 오토잇 매크로의 모든 항목을 실어 두었습니다. 참고하세요. 

매크로를 실제로 사용해 봅시다. 아래 코드를 입력하고 DateTime.au3으로 저장하세요. 

; 06_DateTime.au3

MsgBox(0, "날짜 시각", @Year & "년 " & @Mon & "월 " & @MDay & "일 " & @Hour & "시 " & @Min & "분 " & @Sec & "초")

& 연산자는 문자열과 문자열을 결합해 줍니다. @Year에는 올해 연도가 들어 있고 그것을 "년 "이란 문자열과 결합하면 "2022년 "이 됩니다. 나머지도 이와 같습니다.

## 14. 연산자(operators)

연산자라 하면 말이 너무 어렵습니다만, 덧셈, 뺄셈 같은 기능으로 생각하시면 편할 겁니다. 실제로 대표적인 연산자는 바로 4칙 연산 기호입니다.

+: 덧셈

-: 뺄셈

*:  곱셈

/: 나눗셈

^: 제곱

^은 제곱을 의미합니다. 3^3은 3의 3승으로 27입니다.

4칙 연산과 대입 연산자를 동시에 사용할 수도 있습니다.

$a = $a + 1

위와 같은 코드에서 $a가 반복됩니다. 이것을 이렇게 줄일 수 있습니다.

$a += 1

-> $a += 1

마찬가지로 -=, *=, /=을 모두 사용할 수 있습니다.

$a = $a -1

-> $-= 1

$a = $a * $b

-> $a *= $b

$a = $a / $b

-> $a /= $b

&는 문자열 결합 연산자입니다. 앞에서 소개해 드린 적 있습니다. 여러 줄에 걸쳐서 문자열 결합을 표현할 수 있습니다. 다음과 같이 언더바(_)를 사용하세요.

```autoit

$s = "개미네 집 주소" & @CRLF & _
"허리도 가늘군 만지면 부러지리"

```

@CRLF는  캐리지 리턴과 라인피드를 의미하는 매크로입니다. 다른 언어들에서 \r\n에 해당하는 것입니다. & 연산자 뒤에 언더바(_)를 넣으면 다음 줄에 문자열을 결합할 수 있습니다.

비교를 위한 연산자도 있습니다. 비교한 결과가 참이면 True를 반환하고 비교한 결과가 오류이면 False를 반환합니다. 대표적인 비교 연산자는 부등호 기호입니다.

3 < 7

3은 7보다 작으므로 참입니다. 이 부등식은 True라는 결과로 변합니다. 

7 < 3

이 부등식은 오류입니다. 따라서 False를 반환합니다.

비교 연산자는 다음과 같습니다.

=: 두 항이 같은지를 비교합니다. 단 영어 문자열의 경우 대소문자 구별을 하지 않습니다.
==: 같은지를 평가합니다. 문자열의 경우 대소문자를 엄격히 구별합니다.

1 = 1

-> True

1 = 2

-> False

'abc' = 'ABC'

-> True

'abc' == 'ABC'

-> False

'='은 대입연산자이기도 합니다. 혼동을 피하려면 '='은 대입연산자로 사용하시고 '=='만 비교 연산자로 사용하세요.

"같지 않다"는 <>으로 표시합니다.

"abc" <> "def"

-> True

<> 연산자는 두 항이 같으면 False, 다르면 True를 반환합니다.

이외에 <, >, <=, >=도 비교 연산자로 사용합니다. 각각 보다 작다, 보다 크다, 작거나 같다, 크거나 같다를 의미합니다.

논리 연산자도 있습니다. And, Or, Not이 대표적입니다.

And는 두 항이 모두 True일 때 True를 반환합니다.

Or은 둘 중 하나가 True일 때 True를 반환합니다.

Not은 True를 False로 바꾸고, False를 True로 바꿉니다.

3 < 7 And 7 < 9

-> True And True

-> True

7 > 8 Or 2 < 3

-> False Or True

-> True

Not 0

-> True

숫자 0은 False입니다. "" 빈 문자열도 False입니다. Not은 False를 True로 바꿉니다.


## 15. 주석

코드를 적다보면 이 코드가 어떤 역할을 하던 것인지 깜빡 잊을 때가 있습니다. 코드의 작성 시기가 멀어질수록 이런 경향은 더욱 심해집니다. 그래서 코드는 아니지만 사용자를 위해 힌트를 남겨 놓을 필요가 있습니다. 그것을 주석이라고 부릅니다.

 오토잇에서는 한 줄 주석과 여러 줄 주석을 모두 지원합니다.

한줄 주석은 ";"을 쓰고 그 뒤에 힌트를 남깁니다. 오토잇은 ";" 오른쪽부터 그 줄 끝까지 한줄을 모두 주석으로 처리합니다. 예를 들면 다음과 같습니다.

; 남은 용돈 입력 받기

$Money = Input("용돈", "금액")

여러 줄 주석은 #CS로 시작해서 #CE로 끝납니다. 대체로 소스 코드 최상단에 이 프로그램의 정보를 간략히 기입해 두는 용도로 사용됩니다. 

#CS

파일 이름: MoneyBook.au3

작성자: 장창환

작성일시: 2022년 5월 1일

사용법: 오토잇 교육용이기 때문에 메모장에서 열어 보시면 됩니다.

#CE
 
